<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GIS: GIS.ShapefileReader.RenderThread.cs Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Packages</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<h1>GIS.ShapefileReader.RenderThread.cs</h1><a href="GIS_8ShapefileReader_8RenderThread_8cs.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//</span>
00002 <span class="comment">//RenderThread.cs</span>
00003 <span class="comment">//</span>
00004 
00024 
00025 <span class="keyword">using</span> System;
00026 <span class="keyword">using</span> System.IO;
00027 <span class="keyword">using</span> System.Drawing;
00028 <span class="keyword">using</span> System.Drawing.Drawing2D;
00029 <span class="keyword">using</span> System.Drawing.Imaging;
00030 <span class="keyword">using</span> System.Windows.Forms;
00031 <span class="keyword">using</span> System.Collections;
00032 <span class="keyword">using</span> System.Threading;
00033 
<a name="l00034"></a><a class="code" href="namespaceShapeDotNet_1_1GIS_1_1ShapefileReader.html">00034</a> <span class="keyword">namespace </span>ShapeDotNet.GIS.ShapefileReader
00035 {
<a name="l00043"></a><a class="code" href="classShapeDotNet_1_1GIS_1_1ShapefileReader_1_1RenderThread.html">00043</a>     <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classShapeDotNet_1_1GIS_1_1ShapefileReader_1_1RenderThread.html">RenderThread</a>
00044     {
00045         <span class="keyword">private</span> <a class="code" href="classShapeDotNet_1_1GIS_1_1MapMetrics.html">MapMetrics</a> _mapMetrics;
00046         <span class="keyword">private</span> <a class="code" href="namespaceShapeDotNet_1_1GIS_1_1ShapefileReader.html#a5">ShapeType</a> _shapeType;
00047         <span class="keyword">private</span> <a class="code" href="classShapeDotNet_1_1GIS_1_1VectorFeature.html">VectorFeature</a>[] _features;
00048         <span class="keyword">private</span> Graphics _gr;
00049         <span class="keyword">private</span> <span class="keywordtype">int</span> _beginningFeature;
00050         <span class="keyword">private</span> <span class="keywordtype">int</span> _endingFeature;
00051         <span class="keyword">private</span> Pen _pen;
00052         <span class="keyword">private</span> Brush _brush;
00053 
<a name="l00065"></a><a class="code" href="classShapeDotNet_1_1GIS_1_1ShapefileReader_1_1RenderThread.html#ShapeDotNet_1_1GIS_1_1ShapefileReader_1_1RenderThreada0">00065</a>         <span class="keyword">public</span> <a class="code" href="classShapeDotNet_1_1GIS_1_1ShapefileReader_1_1RenderThread.html">RenderThread</a>( <a class="code" href="classShapeDotNet_1_1GIS_1_1MapMetrics.html">MapMetrics</a> metrics, 
00066                              <a class="code" href="classShapeDotNet_1_1GIS_1_1VectorFeature.html">VectorFeature</a>[] features,
00067                              ShapeType type,
00068                              <span class="keywordtype">int</span> beginning,
00069                              <span class="keywordtype">int</span> ending,
00070                              Pen pen,
00071                              Brush brush )
00072         {
00073             _mapMetrics = metrics;
00074             _features = features;
00075             _shapeType = type;
00076             _beginningFeature = beginning;
00077             _endingFeature = ending;
00078             _pen = (Pen) pen.Clone();
00079             _brush = (Brush) brush.Clone();
00080             _gr = Graphics.FromImage( _mapMetrics.Canvas );
00081         }
00082         
00083         
00088         <span class="keyword">private</span> <span class="keywordtype">void</span> DrawPoints() 
00089         {           
00090             <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> a =_beginningFeature; a&lt;_endingFeature; ++a )
00091             {
00092                 <a class="code" href="classShapeDotNet_1_1GIS_1_1VectorFeature.html">VectorFeature</a> vf = _features[a];
00093 
00094                 <span class="keywordflow">if</span> ( vf.<a class="code" href="classShapeDotNet_1_1GIS_1_1VectorFeature.html#ShapeDotNet_1_1GIS_1_1VectorFeature03">IsInViewport</a> == <span class="keyword">false</span> ) <span class="keywordflow">continue</span>; <span class="comment">// Don't draw this feature</span>
00095 
00096                 <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> segment=0; segment &lt; vf.<a class="code" href="classShapeDotNet_1_1GIS_1_1VectorFeature.html#ShapeDotNet_1_1GIS_1_1VectorFeature04">SegmentCount</a>; ++segment )
00097                 {
00098                     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> point=0; point &lt; vf[segment].Length; ++point )
00099                     {
00100                         _gr.FillEllipse( _brush, vf[segment][point].X,
00101                             vf[segment][point].Y, _pen.Width, _pen.Width );
00102 
00103                         _gr.DrawEllipse( <span class="keyword">new</span> Pen( _pen.Color, 1 ), vf[segment][point].X, 
00104                             vf[segment][point].Y, _pen.Width, _pen.Width );
00105                     }
00106                 }
00107             }
00108     
00109             _gr.Dispose();
00110         }
00111         
00112         
00120         <span class="keyword">private</span> <span class="keywordtype">void</span> DrawPolygons() 
00121         {           
00122             GraphicsPath gp = <span class="keyword">new</span> GraphicsPath();
00123 
00124             <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> a =_beginningFeature; a&lt;_endingFeature; ++a )
00125             {
00126                 VectorFeature vf = _features[a];
00127 
00128                 <span class="keywordflow">if</span> ( vf.IsInViewport == <span class="keyword">false</span> ) <span class="keywordflow">continue</span>; <span class="comment">// Don't draw this feature</span>
00129 
00130                 <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> segment=0; segment &lt; vf.SegmentCount; ++segment )
00131                 {
00132                     gp.AddPolygon( vf[segment] );
00133                     gp.StartFigure();
00134                 }
00135 
00136                 gp.CloseFigure();
00137             }
00138             
00139             _gr.FillPath( _brush, gp );
00140             _gr.DrawPath( _pen, gp );
00141 
00142             gp.Dispose();
00143             _gr.Dispose();
00144         }
00145 
00146         
00151         <span class="keyword">private</span> <span class="keywordtype">void</span> DrawPolyLines() 
00152         {           
00153             <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> a =_beginningFeature; a&lt;_endingFeature; ++a )
00154             {
00155                 VectorFeature vf = _features[a];
00156 
00157                 <span class="keywordflow">if</span> ( vf.IsInViewport == <span class="keyword">false</span> ) <span class="keywordflow">continue</span>; <span class="comment">// Don't draw this feature</span>
00158 
00159                 <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> segment=0; segment &lt; vf.SegmentCount; ++segment )
00160                 {
00161                     _gr.DrawLines( _pen, vf[segment] );
00162                 }
00163             }
00164 
00165             _gr.Dispose();
00166         }
00167         
00168         
00173         <span class="keyword">private</span> <span class="keywordtype">void</span> DrawMultiPoints() 
00174         {
00175             <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> a =_beginningFeature; a&lt;_endingFeature; ++a )
00176             {
00177                 VectorFeature vf = _features[a];
00178 
00179                 <span class="keywordflow">if</span> ( vf.IsInViewport == <span class="keyword">false</span> ) <span class="keywordflow">continue</span>; <span class="comment">// Don't draw this feature</span>
00180 
00181                 <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> segment=0; segment &lt; vf.SegmentCount; ++segment )
00182                 {
00183                     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> point=0; point &lt; vf[segment].Length; ++point )
00184                     {
00185                         _gr.FillEllipse( _brush, vf[segment][point].X,
00186                             vf[segment][point].Y, _pen.Width *3, _pen.Width *3 );
00187 
00188                         _gr.DrawEllipse( <span class="keyword">new</span> Pen( _pen.Color, 1 ), vf[segment][point].X, 
00189                             vf[segment][point].Y, _pen.Width, _pen.Width );
00190                     }
00191                 }
00192             }
00193     
00194             _gr.Dispose();
00195         }
00196 
00197         
<a name="l00201"></a><a class="code" href="classShapeDotNet_1_1GIS_1_1ShapefileReader_1_1RenderThread.html#ShapeDotNet_1_1GIS_1_1ShapefileReader_1_1RenderThreada1">00201</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> Start()
00202         {
00203             <span class="keywordflow">switch</span> ( _shapeType ) 
00204             {
00205                 <span class="keywordflow">case</span> <a class="code" href="namespaceShapeDotNet_1_1GIS_1_1ShapefileReader.html#a5">ShapeType</a>.Point:
00206                     DrawPoints();
00207                     <span class="keywordflow">break</span>;
00208                 <span class="keywordflow">case</span> <a class="code" href="namespaceShapeDotNet_1_1GIS_1_1ShapefileReader.html#a5">ShapeType</a>.Line:
00209                     DrawPolyLines();
00210                     <span class="keywordflow">break</span>;
00211                 <span class="keywordflow">case</span> <a class="code" href="namespaceShapeDotNet_1_1GIS_1_1ShapefileReader.html#a5">ShapeType</a>.Polygon:
00212                     DrawPolygons();
00213                     <span class="keywordflow">break</span>;
00214                 <span class="keywordflow">case</span> <a class="code" href="namespaceShapeDotNet_1_1GIS_1_1ShapefileReader.html#a5">ShapeType</a>.Multipoint:
00215                     DrawMultiPoints();
00216                     <span class="keywordflow">break</span>;
00217                 <span class="keywordflow">default</span>:
00218                     Console.WriteLine(<span class="stringliteral">"\n\t\t**Danger Will Robinson!!**\n"</span>);
00219                     Console.WriteLine(<span class="stringliteral">"\t\tUnsupported Shape Type (Type: "</span> + 
00220                         _shapeType + <span class="stringliteral">")"</span>);
00221                     <span class="keywordflow">break</span>;
00222             }
00223         }
00224     }
00225 }
00226 
00227 
00228 <span class="comment">/*                    *** Code parking lot ***</span>
00229 <span class="comment"> </span>
00230 <span class="comment"></span>
00231 <span class="comment">                    -&gt; from DrawPolyLines() &lt;-</span>
00232 <span class="comment">                    for ( int point=0; point &lt; vf[segment].Length - 1; ++point )</span>
00233 <span class="comment">                    {</span>
00234 <span class="comment">                        _gr.DrawLine( new Pen( Color.Black ), </span>
00235 <span class="comment">                            vf[segment][point].X, vf[segment][point].Y, </span>
00236 <span class="comment">                            vf[segment][point+1].X, vf[segment][point+1].Y );</span>
00237 <span class="comment">                    }</span>
00238 <span class="comment">                    </span>
00239 <span class="comment">*/</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Feb 10 17:52:24 2004 for GIS by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
