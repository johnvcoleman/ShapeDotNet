<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>MapControl: Form1.cs Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Packages</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<h1>Form1.cs</h1><a href="Form1_8cs.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//</span>
00002 <span class="comment">//Form1.cs</span>
00003 <span class="comment">//</span>
00004 
00023 
00024 <span class="keyword">using</span> System;
00025 <span class="keyword">using</span> System.Drawing;
00026 <span class="keyword">using</span> System.Collections;
00027 <span class="keyword">using</span> System.ComponentModel;
00028 <span class="keyword">using</span> System.Windows.Forms;
00029 <span class="keyword">using</span> System.Data;
00030 
00031 <span class="keyword">using</span> ShapeDotNet;
00032 <span class="keyword">using</span> ShapeDotNet.GIS;
00033 
<a name="l00034"></a><a class="code" href="namespaceExampleApplication.html">00034</a> <span class="keyword">namespace </span>ExampleApplication
00035 {
<a name="l00039"></a><a class="code" href="classExampleApplication_1_1Form1.html">00039</a>     <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classExampleApplication_1_1Form1.html">Form1</a> : System.Windows.Forms.Form
00040     {
00041         <span class="keyword">private</span> <span class="keywordtype">int</span> queryField;
00042         
00043         <span class="keyword">private</span> System.Windows.Forms.MainMenu mainMenu1;
00044         <span class="keyword">private</span> System.Windows.Forms.MenuItem menuItem1;
00045         <span class="keyword">private</span> System.Windows.Forms.MenuItem menuItem3;
00046         <span class="keyword">private</span> System.Windows.Forms.StatusBar statusBar1;
00047         <span class="keyword">private</span> System.Windows.Forms.StatusBarPanel statusBarPanel1;
00048         <span class="keyword">private</span> System.Windows.Forms.StatusBarPanel statusBarPanel2;
00049         <span class="keyword">private</span> System.Windows.Forms.StatusBarPanel statusBarPanel3;
00050         <span class="keyword">private</span> System.ComponentModel.IContainer components;
00051         <span class="keyword">private</span> System.Windows.Forms.MenuItem menuOpenFile;
00052         <span class="keyword">private</span> System.Windows.Forms.MenuItem menuExit;
00053         <span class="keyword">private</span> System.Windows.Forms.MenuItem menuHelp;
00054         <span class="keyword">private</span> System.Windows.Forms.MenuItem menuHelpAbout;
00055 
00056         <span class="keyword">private</span> System.Windows.Forms.ImageList imageList1;
00057         <span class="keyword">private</span> System.Windows.Forms.MenuItem menuItem6;
00058         <span class="keyword">private</span> System.Windows.Forms.MenuItem menuSaveViewTo;
00059         <span class="keyword">private</span> System.Windows.Forms.MenuItem menuItemSaveToImage;
00060         <span class="keyword">private</span> System.Windows.Forms.Panel panel1;
00061         <span class="keyword">private</span> System.Windows.Forms.Splitter splitter1;
00062         <span class="keyword">private</span> ShapeDotNet.MapControl mapControl;
00063         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton pointerButton;
00064         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton zoomButton;
00065         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton zoomAreaButton;
00066         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton dragButton;
00067         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton centerButton;
00068         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton queryButton;
00069         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton extentsButton;
00070         <span class="keyword">private</span> System.Windows.Forms.GroupBox groupBox1;
00071         <span class="keyword">private</span> System.Windows.Forms.ToolBar mainToolBar;
00072         <span class="keyword">private</span> System.Windows.Forms.ListBox layerListBox;
00073         <span class="keyword">private</span> System.Windows.Forms.ToolBar layerToolBar;
00074         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton addLayerButton;
00075         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton removeLayerButton;
00076         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton toolBarSeparator1;
00077         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton moveLayerUpButton;
00078         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton moveLayerDownButton;
00079         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton layerPropertiesButton;
00080         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton toolBarButton1;
00081         <span class="keyword">private</span> System.Windows.Forms.ToolBarButton toolBarButton2;
00082         <span class="keyword">private</span> System.Windows.Forms.GroupBox groupBox2;
00083         <span class="keyword">private</span> System.Windows.Forms.Button clearSelectionButton;
00084         <span class="keyword">private</span> System.Windows.Forms.ComboBox queryComboBox;
00085 
<a name="l00086"></a><a class="code" href="classExampleApplication_1_1Form1.html#ExampleApplication_1_1Form1a0">00086</a>         <span class="keyword">public</span> <a class="code" href="classExampleApplication_1_1Form1.html#ExampleApplication_1_1Form1a0">Form1</a>()
00087         {
00088             <span class="comment">//</span>
00089             <span class="comment">// Required for Windows Form Designer support</span>
00090             <span class="comment">//</span>
00091             InitializeComponent();
00092 
00093             <span class="comment">//</span>
00094             <span class="comment">// TODO: Add any constructor code after InitializeComponent call</span>
00095             <span class="comment">//</span>
00096             mapControl.OnQueryResult += <span class="keyword">new</span> QueryResultEventHandler( <span class="keyword">this</span>.mapControl_QueryResult );
00097         }
00098 
<a name="l00102"></a><a class="code" href="classExampleApplication_1_1Form1.html#ExampleApplication_1_1Form1b0">00102</a>         <span class="keyword">protected</span> override <span class="keywordtype">void</span> <a class="code" href="classExampleApplication_1_1Form1.html#ExampleApplication_1_1Form1b0">Dispose</a>( <span class="keywordtype">bool</span> disposing )
00103         {
00104             <span class="keywordflow">if</span>( disposing )
00105             {
00106                 <span class="keywordflow">if</span> (components != null) 
00107                 {
00108                     components.Dispose();
00109                 }
00110             }
00111             base.Dispose( disposing );
00112         }
00113 
00114 <span class="preprocessor">        #region Windows Form Designer generated code</span>
00119 <span class="preprocessor">        private void InitializeComponent()</span>
00120 <span class="preprocessor"></span>        {
00121             <span class="keyword">this</span>.components = <span class="keyword">new</span> System.ComponentModel.Container();
00122             System.Resources.ResourceManager resources = <span class="keyword">new</span> System.Resources.ResourceManager(typeof(<a class="code" href="classExampleApplication_1_1Form1.html">Form1</a>));
00123             <span class="keyword">this</span>.mainMenu1 = <span class="keyword">new</span> System.Windows.Forms.MainMenu();
00124             <span class="keyword">this</span>.menuItem1 = <span class="keyword">new</span> System.Windows.Forms.MenuItem();
00125             <span class="keyword">this</span>.menuOpenFile = <span class="keyword">new</span> System.Windows.Forms.MenuItem();
00126             <span class="keyword">this</span>.menuItem3 = <span class="keyword">new</span> System.Windows.Forms.MenuItem();
00127             <span class="keyword">this</span>.menuSaveViewTo = <span class="keyword">new</span> System.Windows.Forms.MenuItem();
00128             <span class="keyword">this</span>.menuItemSaveToImage = <span class="keyword">new</span> System.Windows.Forms.MenuItem();
00129             <span class="keyword">this</span>.menuItem6 = <span class="keyword">new</span> System.Windows.Forms.MenuItem();
00130             <span class="keyword">this</span>.menuExit = <span class="keyword">new</span> System.Windows.Forms.MenuItem();
00131             <span class="keyword">this</span>.menuHelp = <span class="keyword">new</span> System.Windows.Forms.MenuItem();
00132             <span class="keyword">this</span>.menuHelpAbout = <span class="keyword">new</span> System.Windows.Forms.MenuItem();
00133             <span class="keyword">this</span>.statusBar1 = <span class="keyword">new</span> System.Windows.Forms.StatusBar();
00134             <span class="keyword">this</span>.statusBarPanel1 = <span class="keyword">new</span> System.Windows.Forms.StatusBarPanel();
00135             <span class="keyword">this</span>.statusBarPanel2 = <span class="keyword">new</span> System.Windows.Forms.StatusBarPanel();
00136             <span class="keyword">this</span>.statusBarPanel3 = <span class="keyword">new</span> System.Windows.Forms.StatusBarPanel();
00137             <span class="keyword">this</span>.imageList1 = <span class="keyword">new</span> System.Windows.Forms.ImageList(<span class="keyword">this</span>.components);
00138             <span class="keyword">this</span>.panel1 = <span class="keyword">new</span> System.Windows.Forms.Panel();
00139             <span class="keyword">this</span>.groupBox2 = <span class="keyword">new</span> System.Windows.Forms.GroupBox();
00140             <span class="keyword">this</span>.queryComboBox = <span class="keyword">new</span> System.Windows.Forms.ComboBox();
00141             <span class="keyword">this</span>.groupBox1 = <span class="keyword">new</span> System.Windows.Forms.GroupBox();
00142             <span class="keyword">this</span>.layerToolBar = <span class="keyword">new</span> System.Windows.Forms.ToolBar();
00143             <span class="keyword">this</span>.addLayerButton = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00144             <span class="keyword">this</span>.removeLayerButton = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00145             <span class="keyword">this</span>.toolBarButton1 = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00146             <span class="keyword">this</span>.toolBarSeparator1 = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00147             <span class="keyword">this</span>.moveLayerUpButton = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00148             <span class="keyword">this</span>.moveLayerDownButton = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00149             <span class="keyword">this</span>.toolBarButton2 = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00150             <span class="keyword">this</span>.layerPropertiesButton = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00151             <span class="keyword">this</span>.layerListBox = <span class="keyword">new</span> System.Windows.Forms.ListBox();
00152             <span class="keyword">this</span>.mainToolBar = <span class="keyword">new</span> System.Windows.Forms.ToolBar();
00153             <span class="keyword">this</span>.pointerButton = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00154             <span class="keyword">this</span>.zoomButton = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00155             <span class="keyword">this</span>.zoomAreaButton = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00156             <span class="keyword">this</span>.dragButton = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00157             <span class="keyword">this</span>.centerButton = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00158             <span class="keyword">this</span>.queryButton = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00159             <span class="keyword">this</span>.extentsButton = <span class="keyword">new</span> System.Windows.Forms.ToolBarButton();
00160             <span class="keyword">this</span>.splitter1 = <span class="keyword">new</span> System.Windows.Forms.Splitter();
00161             <span class="keyword">this</span>.mapControl = <span class="keyword">new</span> ShapeDotNet.MapControl();
00162             <span class="keyword">this</span>.clearSelectionButton = <span class="keyword">new</span> System.Windows.Forms.Button();
00163             ((System.ComponentModel.ISupportInitialize)(<span class="keyword">this</span>.statusBarPanel1)).BeginInit();
00164             ((System.ComponentModel.ISupportInitialize)(<span class="keyword">this</span>.statusBarPanel2)).BeginInit();
00165             ((System.ComponentModel.ISupportInitialize)(<span class="keyword">this</span>.statusBarPanel3)).BeginInit();
00166             <span class="keyword">this</span>.panel1.SuspendLayout();
00167             <span class="keyword">this</span>.groupBox2.SuspendLayout();
00168             <span class="keyword">this</span>.groupBox1.SuspendLayout();
00169             <span class="keyword">this</span>.SuspendLayout();
00170             <span class="comment">// </span>
00171             <span class="comment">// mainMenu1</span>
00172             <span class="comment">// </span>
00173             <span class="keyword">this</span>.mainMenu1.MenuItems.AddRange(<span class="keyword">new</span> System.Windows.Forms.MenuItem[] {
00174                                                                                       <span class="keyword">this</span>.menuItem1,
00175                                                                                       <span class="keyword">this</span>.menuHelp});
00176             <span class="comment">// </span>
00177             <span class="comment">// menuItem1</span>
00178             <span class="comment">// </span>
00179             <span class="keyword">this</span>.menuItem1.Index = 0;
00180             <span class="keyword">this</span>.menuItem1.MenuItems.AddRange(<span class="keyword">new</span> System.Windows.Forms.MenuItem[] {
00181                                                                                       <span class="keyword">this</span>.menuOpenFile,
00182                                                                                       <span class="keyword">this</span>.menuItem3,
00183                                                                                       <span class="keyword">this</span>.menuSaveViewTo,
00184                                                                                       <span class="keyword">this</span>.menuItem6,
00185                                                                                       <span class="keyword">this</span>.menuExit});
00186             <span class="keyword">this</span>.menuItem1.Text = <span class="stringliteral">"&amp;File"</span>;
00187             <span class="comment">// </span>
00188             <span class="comment">// menuOpenFile</span>
00189             <span class="comment">// </span>
00190             <span class="keyword">this</span>.menuOpenFile.Index = 0;
00191             <span class="keyword">this</span>.menuOpenFile.Text = <span class="stringliteral">"&amp;Open Shape File"</span>;
00192             <span class="keyword">this</span>.menuOpenFile.Click += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.menuOpenFile_Click);
00193             <span class="comment">// </span>
00194             <span class="comment">// menuItem3</span>
00195             <span class="comment">// </span>
00196             <span class="keyword">this</span>.menuItem3.Index = 1;
00197             <span class="keyword">this</span>.menuItem3.Text = <span class="stringliteral">"-"</span>;
00198             <span class="comment">// </span>
00199             <span class="comment">// menuSaveViewTo</span>
00200             <span class="comment">// </span>
00201             <span class="keyword">this</span>.menuSaveViewTo.Index = 2;
00202             <span class="keyword">this</span>.menuSaveViewTo.MenuItems.AddRange(<span class="keyword">new</span> System.Windows.Forms.MenuItem[] {
00203                                                                                            <span class="keyword">this</span>.menuItemSaveToImage});
00204             <span class="keyword">this</span>.menuSaveViewTo.Text = <span class="stringliteral">"&amp;Save View As..."</span>;
00205             <span class="comment">// </span>
00206             <span class="comment">// menuItemSaveToImage</span>
00207             <span class="comment">// </span>
00208             <span class="keyword">this</span>.menuItemSaveToImage.Index = 0;
00209             <span class="keyword">this</span>.menuItemSaveToImage.Text = <span class="stringliteral">"Image"</span>;
00210             <span class="keyword">this</span>.menuItemSaveToImage.Click += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.menuItemSaveToImage_Click);
00211             <span class="comment">// </span>
00212             <span class="comment">// menuItem6</span>
00213             <span class="comment">// </span>
00214             <span class="keyword">this</span>.menuItem6.Index = 3;
00215             <span class="keyword">this</span>.menuItem6.Text = <span class="stringliteral">"-"</span>;
00216             <span class="comment">// </span>
00217             <span class="comment">// menuExit</span>
00218             <span class="comment">// </span>
00219             <span class="keyword">this</span>.menuExit.Index = 4;
00220             <span class="keyword">this</span>.menuExit.Text = <span class="stringliteral">"E&amp;xit"</span>;
00221             <span class="keyword">this</span>.menuExit.Click += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.menuExit_Click);
00222             <span class="comment">// </span>
00223             <span class="comment">// menuHelp</span>
00224             <span class="comment">// </span>
00225             <span class="keyword">this</span>.menuHelp.Index = 1;
00226             <span class="keyword">this</span>.menuHelp.MenuItems.AddRange(<span class="keyword">new</span> System.Windows.Forms.MenuItem[] {
00227                                                                                      <span class="keyword">this</span>.menuHelpAbout});
00228             <span class="keyword">this</span>.menuHelp.Text = <span class="stringliteral">"&amp;Help"</span>;
00229             <span class="comment">// </span>
00230             <span class="comment">// menuHelpAbout</span>
00231             <span class="comment">// </span>
00232             <span class="keyword">this</span>.menuHelpAbout.Index = 0;
00233             <span class="keyword">this</span>.menuHelpAbout.Text = <span class="stringliteral">"&amp;About"</span>;
00234             <span class="keyword">this</span>.menuHelpAbout.Click += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.menuHelpAbout_Click);
00235             <span class="comment">// </span>
00236             <span class="comment">// statusBar1</span>
00237             <span class="comment">// </span>
00238             <span class="keyword">this</span>.statusBar1.Location = <span class="keyword">new</span> System.Drawing.Point(0, 302);
00239             <span class="keyword">this</span>.statusBar1.Name = <span class="stringliteral">"statusBar1"</span>;
00240             <span class="keyword">this</span>.statusBar1.Panels.AddRange(<span class="keyword">new</span> System.Windows.Forms.StatusBarPanel[] {
00241                                                                                           <span class="keyword">this</span>.statusBarPanel1,
00242                                                                                           <span class="keyword">this</span>.statusBarPanel2,
00243                                                                                           <span class="keyword">this</span>.statusBarPanel3});
00244             <span class="keyword">this</span>.statusBar1.ShowPanels = <span class="keyword">true</span>;
00245             <span class="keyword">this</span>.statusBar1.Size = <span class="keyword">new</span> System.Drawing.Size(500, 22);
00246             <span class="keyword">this</span>.statusBar1.TabIndex = 2;
00247             <span class="comment">// </span>
00248             <span class="comment">// statusBarPanel1</span>
00249             <span class="comment">// </span>
00250             <span class="keyword">this</span>.statusBarPanel1.Alignment = System.Windows.Forms.HorizontalAlignment.Center;
00251             <span class="keyword">this</span>.statusBarPanel1.AutoSize = System.Windows.Forms.StatusBarPanelAutoSize.Contents;
00252             <span class="keyword">this</span>.statusBarPanel1.MinWidth = 200;
00253             <span class="keyword">this</span>.statusBarPanel1.Width = 200;
00254             <span class="comment">// </span>
00255             <span class="comment">// statusBarPanel2</span>
00256             <span class="comment">// </span>
00257             <span class="keyword">this</span>.statusBarPanel2.Alignment = System.Windows.Forms.HorizontalAlignment.Center;
00258             <span class="keyword">this</span>.statusBarPanel2.AutoSize = System.Windows.Forms.StatusBarPanelAutoSize.Contents;
00259             <span class="keyword">this</span>.statusBarPanel2.MinWidth = 150;
00260             <span class="keyword">this</span>.statusBarPanel2.Width = 150;
00261             <span class="comment">// </span>
00262             <span class="comment">// statusBarPanel3</span>
00263             <span class="comment">// </span>
00264             <span class="keyword">this</span>.statusBarPanel3.Alignment = System.Windows.Forms.HorizontalAlignment.Right;
00265             <span class="keyword">this</span>.statusBarPanel3.AutoSize = System.Windows.Forms.StatusBarPanelAutoSize.Spring;
00266             <span class="keyword">this</span>.statusBarPanel3.MinWidth = 60;
00267             <span class="keyword">this</span>.statusBarPanel3.Width = 134;
00268             <span class="comment">// </span>
00269             <span class="comment">// imageList1</span>
00270             <span class="comment">// </span>
00271             <span class="keyword">this</span>.imageList1.ColorDepth = System.Windows.Forms.ColorDepth.Depth8Bit;
00272             <span class="keyword">this</span>.imageList1.ImageSize = <span class="keyword">new</span> System.Drawing.Size(16, 16);
00273             <span class="keyword">this</span>.imageList1.ImageStream = ((System.Windows.Forms.ImageListStreamer)(resources.GetObject(<span class="stringliteral">"imageList1.ImageStream"</span>)));
00274             <span class="keyword">this</span>.imageList1.TransparentColor = System.Drawing.Color.White;
00275             <span class="comment">// </span>
00276             <span class="comment">// panel1</span>
00277             <span class="comment">// </span>
00278             <span class="keyword">this</span>.panel1.Controls.AddRange(<span class="keyword">new</span> System.Windows.Forms.Control[] {
00279                                                                                  <span class="keyword">this</span>.groupBox2,
00280                                                                                  <span class="keyword">this</span>.groupBox1,
00281                                                                                  <span class="keyword">this</span>.mainToolBar});
00282             <span class="keyword">this</span>.panel1.Dock = System.Windows.Forms.DockStyle.Left;
00283             <span class="keyword">this</span>.panel1.DockPadding.Left = 3;
00284             <span class="keyword">this</span>.panel1.DockPadding.Right = 3;
00285             <span class="keyword">this</span>.panel1.Name = <span class="stringliteral">"panel1"</span>;
00286             <span class="keyword">this</span>.panel1.Size = <span class="keyword">new</span> System.Drawing.Size(152, 302);
00287             <span class="keyword">this</span>.panel1.TabIndex = 5;
00288             <span class="comment">// </span>
00289             <span class="comment">// groupBox2</span>
00290             <span class="comment">// </span>
00291             <span class="keyword">this</span>.groupBox2.Controls.AddRange(<span class="keyword">new</span> System.Windows.Forms.Control[] {
00292                                                                                     <span class="keyword">this</span>.clearSelectionButton,
00293                                                                                     <span class="keyword">this</span>.queryComboBox});
00294             <span class="keyword">this</span>.groupBox2.Dock = System.Windows.Forms.DockStyle.Top;
00295             <span class="keyword">this</span>.groupBox2.Location = <span class="keyword">new</span> System.Drawing.Point(3, 188);
00296             <span class="keyword">this</span>.groupBox2.Name = <span class="stringliteral">"groupBox2"</span>;
00297             <span class="keyword">this</span>.groupBox2.Size = <span class="keyword">new</span> System.Drawing.Size(146, 76);
00298             <span class="keyword">this</span>.groupBox2.TabIndex = 5;
00299             <span class="keyword">this</span>.groupBox2.TabStop = <span class="keyword">false</span>;
00300             <span class="keyword">this</span>.groupBox2.Text = <span class="stringliteral">"Query Field"</span>;
00301             <span class="comment">// </span>
00302             <span class="comment">// queryComboBox</span>
00303             <span class="comment">// </span>
00304             <span class="keyword">this</span>.queryComboBox.Anchor = System.Windows.Forms.AnchorStyles.Top;
00305             <span class="keyword">this</span>.queryComboBox.Location = <span class="keyword">new</span> System.Drawing.Point(3, 20);
00306             <span class="keyword">this</span>.queryComboBox.Name = <span class="stringliteral">"queryComboBox"</span>;
00307             <span class="keyword">this</span>.queryComboBox.Size = <span class="keyword">new</span> System.Drawing.Size(140, 21);
00308             <span class="keyword">this</span>.queryComboBox.TabIndex = 6;
00309             <span class="keyword">this</span>.queryComboBox.Text = <span class="stringliteral">"Query Source Field"</span>;
00310             <span class="keyword">this</span>.queryComboBox.SelectionChangeCommitted += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.queryComboBox_SelectionChangeCommitted);
00311             <span class="comment">// </span>
00312             <span class="comment">// groupBox1</span>
00313             <span class="comment">// </span>
00314             <span class="keyword">this</span>.groupBox1.Controls.AddRange(<span class="keyword">new</span> System.Windows.Forms.Control[] {
00315                                                                                     <span class="keyword">this</span>.layerToolBar,
00316                                                                                     <span class="keyword">this</span>.layerListBox});
00317             <span class="keyword">this</span>.groupBox1.Dock = System.Windows.Forms.DockStyle.Top;
00318             <span class="keyword">this</span>.groupBox1.Location = <span class="keyword">new</span> System.Drawing.Point(3, 47);
00319             <span class="keyword">this</span>.groupBox1.Name = <span class="stringliteral">"groupBox1"</span>;
00320             <span class="keyword">this</span>.groupBox1.Size = <span class="keyword">new</span> System.Drawing.Size(146, 141);
00321             <span class="keyword">this</span>.groupBox1.TabIndex = 4;
00322             <span class="keyword">this</span>.groupBox1.TabStop = <span class="keyword">false</span>;
00323             <span class="keyword">this</span>.groupBox1.Text = <span class="stringliteral">"Layers"</span>;
00324             <span class="comment">// </span>
00325             <span class="comment">// layerToolBar</span>
00326             <span class="comment">// </span>
00327             <span class="keyword">this</span>.layerToolBar.Buttons.AddRange(<span class="keyword">new</span> System.Windows.Forms.ToolBarButton[] {
00328                                                                                             <span class="keyword">this</span>.addLayerButton,
00329                                                                                             <span class="keyword">this</span>.removeLayerButton,
00330                                                                                             <span class="keyword">this</span>.toolBarButton1,
00331                                                                                             <span class="keyword">this</span>.toolBarSeparator1,
00332                                                                                             <span class="keyword">this</span>.moveLayerUpButton,
00333                                                                                             <span class="keyword">this</span>.moveLayerDownButton,
00334                                                                                             <span class="keyword">this</span>.toolBarButton2,
00335                                                                                             <span class="keyword">this</span>.layerPropertiesButton});
00336             <span class="keyword">this</span>.layerToolBar.ButtonSize = <span class="keyword">new</span> System.Drawing.Size(23, 22);
00337             <span class="keyword">this</span>.layerToolBar.DropDownArrows = <span class="keyword">true</span>;
00338             <span class="keyword">this</span>.layerToolBar.ImageList = <span class="keyword">this</span>.imageList1;
00339             <span class="keyword">this</span>.layerToolBar.Location = <span class="keyword">new</span> System.Drawing.Point(3, 111);
00340             <span class="keyword">this</span>.layerToolBar.Name = <span class="stringliteral">"layerToolBar"</span>;
00341             <span class="keyword">this</span>.layerToolBar.ShowToolTips = <span class="keyword">true</span>;
00342             <span class="keyword">this</span>.layerToolBar.Size = <span class="keyword">new</span> System.Drawing.Size(140, 25);
00343             <span class="keyword">this</span>.layerToolBar.TabIndex = 11;
00344             <span class="keyword">this</span>.layerToolBar.ButtonClick += <span class="keyword">new</span> System.Windows.Forms.ToolBarButtonClickEventHandler(<span class="keyword">this</span>.layerToolBar_ButtonClick);
00345             <span class="comment">// </span>
00346             <span class="comment">// addLayerButton</span>
00347             <span class="comment">// </span>
00348             <span class="keyword">this</span>.addLayerButton.ImageIndex = 8;
00349             <span class="keyword">this</span>.addLayerButton.ToolTipText = <span class="stringliteral">"Add a New Layer"</span>;
00350             <span class="comment">// </span>
00351             <span class="comment">// removeLayerButton</span>
00352             <span class="comment">// </span>
00353             <span class="keyword">this</span>.removeLayerButton.ImageIndex = 9;
00354             <span class="keyword">this</span>.removeLayerButton.ToolTipText = <span class="stringliteral">"Remove the currently selected layer"</span>;
00355             <span class="comment">// </span>
00356             <span class="comment">// toolBarButton1</span>
00357             <span class="comment">// </span>
00358             <span class="keyword">this</span>.toolBarButton1.Style = System.Windows.Forms.ToolBarButtonStyle.Separator;
00359             <span class="comment">// </span>
00360             <span class="comment">// toolBarSeparator1</span>
00361             <span class="comment">// </span>
00362             <span class="keyword">this</span>.toolBarSeparator1.Style = System.Windows.Forms.ToolBarButtonStyle.Separator;
00363             <span class="comment">// </span>
00364             <span class="comment">// moveLayerUpButton</span>
00365             <span class="comment">// </span>
00366             <span class="keyword">this</span>.moveLayerUpButton.ImageIndex = 11;
00367             <span class="keyword">this</span>.moveLayerUpButton.ToolTipText = <span class="stringliteral">"Move the currently selected layer \'up\'"</span>;
00368             <span class="comment">// </span>
00369             <span class="comment">// moveLayerDownButton</span>
00370             <span class="comment">// </span>
00371             <span class="keyword">this</span>.moveLayerDownButton.ImageIndex = 12;
00372             <span class="keyword">this</span>.moveLayerDownButton.ToolTipText = <span class="stringliteral">"Move the currently selected layer \'down\'"</span>;
00373             <span class="comment">// </span>
00374             <span class="comment">// toolBarButton2</span>
00375             <span class="comment">// </span>
00376             <span class="keyword">this</span>.toolBarButton2.Style = System.Windows.Forms.ToolBarButtonStyle.Separator;
00377             <span class="comment">// </span>
00378             <span class="comment">// layerPropertiesButton</span>
00379             <span class="comment">// </span>
00380             <span class="keyword">this</span>.layerPropertiesButton.ImageIndex = 10;
00381             <span class="keyword">this</span>.layerPropertiesButton.ToolTipText = <span class="stringliteral">"Show the properties of the currently selected layer"</span>;
00382             <span class="comment">// </span>
00383             <span class="comment">// layerListBox</span>
00384             <span class="comment">// </span>
00385             <span class="keyword">this</span>.layerListBox.Dock = System.Windows.Forms.DockStyle.Top;
00386             <span class="keyword">this</span>.layerListBox.Location = <span class="keyword">new</span> System.Drawing.Point(3, 16);
00387             <span class="keyword">this</span>.layerListBox.Name = <span class="stringliteral">"layerListBox"</span>;
00388             <span class="keyword">this</span>.layerListBox.Size = <span class="keyword">new</span> System.Drawing.Size(140, 95);
00389             <span class="keyword">this</span>.layerListBox.TabIndex = 10;
00390             <span class="keyword">this</span>.layerListBox.SelectedValueChanged += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.layerListBox_SelectedValueChanged);
00391             <span class="comment">// </span>
00392             <span class="comment">// mainToolBar</span>
00393             <span class="comment">// </span>
00394             <span class="keyword">this</span>.mainToolBar.Appearance = System.Windows.Forms.ToolBarAppearance.Flat;
00395             <span class="keyword">this</span>.mainToolBar.Buttons.AddRange(<span class="keyword">new</span> System.Windows.Forms.ToolBarButton[] {
00396                                                                                            <span class="keyword">this</span>.pointerButton,
00397                                                                                            <span class="keyword">this</span>.zoomButton,
00398                                                                                            <span class="keyword">this</span>.zoomAreaButton,
00399                                                                                            <span class="keyword">this</span>.dragButton,
00400                                                                                            <span class="keyword">this</span>.centerButton,
00401                                                                                            <span class="keyword">this</span>.queryButton,
00402                                                                                            <span class="keyword">this</span>.extentsButton});
00403             <span class="keyword">this</span>.mainToolBar.DropDownArrows = <span class="keyword">true</span>;
00404             <span class="keyword">this</span>.mainToolBar.ImageList = <span class="keyword">this</span>.imageList1;
00405             <span class="keyword">this</span>.mainToolBar.Location = <span class="keyword">new</span> System.Drawing.Point(3, 0);
00406             <span class="keyword">this</span>.mainToolBar.Name = <span class="stringliteral">"mainToolBar"</span>;
00407             <span class="keyword">this</span>.mainToolBar.ShowToolTips = <span class="keyword">true</span>;
00408             <span class="keyword">this</span>.mainToolBar.Size = <span class="keyword">new</span> System.Drawing.Size(146, 47);
00409             <span class="keyword">this</span>.mainToolBar.TabIndex = 3;
00410             <span class="keyword">this</span>.mainToolBar.ButtonClick += <span class="keyword">new</span> System.Windows.Forms.ToolBarButtonClickEventHandler(<span class="keyword">this</span>.toolBar1_ButtonClick);
00411             <span class="comment">// </span>
00412             <span class="comment">// pointerButton</span>
00413             <span class="comment">// </span>
00414             <span class="keyword">this</span>.pointerButton.ImageIndex = 0;
00415             <span class="keyword">this</span>.pointerButton.Pushed = <span class="keyword">true</span>;
00416             <span class="keyword">this</span>.pointerButton.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton;
00417             <span class="keyword">this</span>.pointerButton.ToolTipText = <span class="stringliteral">"Select"</span>;
00418             <span class="comment">// </span>
00419             <span class="comment">// zoomButton</span>
00420             <span class="comment">// </span>
00421             <span class="keyword">this</span>.zoomButton.ImageIndex = 1;
00422             <span class="keyword">this</span>.zoomButton.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton;
00423             <span class="keyword">this</span>.zoomButton.ToolTipText = <span class="stringliteral">"Zoom In/Out"</span>;
00424             <span class="comment">// </span>
00425             <span class="comment">// zoomAreaButton</span>
00426             <span class="comment">// </span>
00427             <span class="keyword">this</span>.zoomAreaButton.ImageIndex = 2;
00428             <span class="keyword">this</span>.zoomAreaButton.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton;
00429             <span class="keyword">this</span>.zoomAreaButton.ToolTipText = <span class="stringliteral">"Zoom Area"</span>;
00430             <span class="comment">// </span>
00431             <span class="comment">// dragButton</span>
00432             <span class="comment">// </span>
00433             <span class="keyword">this</span>.dragButton.ImageIndex = 3;
00434             <span class="keyword">this</span>.dragButton.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton;
00435             <span class="keyword">this</span>.dragButton.ToolTipText = <span class="stringliteral">"Drag"</span>;
00436             <span class="comment">// </span>
00437             <span class="comment">// centerButton</span>
00438             <span class="comment">// </span>
00439             <span class="keyword">this</span>.centerButton.ImageIndex = 4;
00440             <span class="keyword">this</span>.centerButton.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton;
00441             <span class="keyword">this</span>.centerButton.ToolTipText = <span class="stringliteral">"Center On Click"</span>;
00442             <span class="comment">// </span>
00443             <span class="comment">// queryButton</span>
00444             <span class="comment">// </span>
00445             <span class="keyword">this</span>.queryButton.ImageIndex = 5;
00446             <span class="keyword">this</span>.queryButton.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton;
00447             <span class="keyword">this</span>.queryButton.ToolTipText = <span class="stringliteral">"Query"</span>;
00448             <span class="comment">// </span>
00449             <span class="comment">// extentsButton</span>
00450             <span class="comment">// </span>
00451             <span class="keyword">this</span>.extentsButton.ImageIndex = 6;
00452             <span class="keyword">this</span>.extentsButton.ToolTipText = <span class="stringliteral">"Zoom To Extents"</span>;
00453             <span class="comment">// </span>
00454             <span class="comment">// splitter1</span>
00455             <span class="comment">// </span>
00456             <span class="keyword">this</span>.splitter1.Location = <span class="keyword">new</span> System.Drawing.Point(152, 0);
00457             <span class="keyword">this</span>.splitter1.Name = <span class="stringliteral">"splitter1"</span>;
00458             <span class="keyword">this</span>.splitter1.Size = <span class="keyword">new</span> System.Drawing.Size(3, 302);
00459             <span class="keyword">this</span>.splitter1.TabIndex = 6;
00460             <span class="keyword">this</span>.splitter1.TabStop = <span class="keyword">false</span>;
00461             <span class="comment">// </span>
00462             <span class="comment">// mapControl</span>
00463             <span class="comment">// </span>
00464             <span class="keyword">this</span>.mapControl.BackColor = System.Drawing.SystemColors.Window;
00465             <span class="keyword">this</span>.mapControl.Cursor = System.Windows.Forms.Cursors.Default;
00466             <span class="keyword">this</span>.mapControl.Dock = System.Windows.Forms.DockStyle.Fill;
00467             <span class="keyword">this</span>.mapControl.Location = <span class="keyword">new</span> System.Drawing.Point(155, 0);
00468             <span class="keyword">this</span>.mapControl.Name = <span class="stringliteral">"mapControl"</span>;
00469             <span class="keyword">this</span>.mapControl.PointerBehavior = ShapeDotNet.PointerMode.Select;
00470             <span class="keyword">this</span>.mapControl.QueryLayer = -1;
00471             <span class="keyword">this</span>.mapControl.Size = <span class="keyword">new</span> System.Drawing.Size(345, 302);
00472             <span class="keyword">this</span>.mapControl.TabIndex = 7;
00473             <span class="keyword">this</span>.mapControl.MouseMove += <span class="keyword">new</span> System.Windows.Forms.MouseEventHandler(<span class="keyword">this</span>.mapControl_MouseMove);
00474             <span class="comment">// </span>
00475             <span class="comment">// clearSelectionButton</span>
00476             <span class="comment">// </span>
00477             <span class="keyword">this</span>.clearSelectionButton.Anchor = (System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left);
00478             <span class="keyword">this</span>.clearSelectionButton.Location = <span class="keyword">new</span> System.Drawing.Point(4, 48);
00479             <span class="keyword">this</span>.clearSelectionButton.Name = <span class="stringliteral">"clearSelectionButton"</span>;
00480             <span class="keyword">this</span>.clearSelectionButton.Size = <span class="keyword">new</span> System.Drawing.Size(136, 23);
00481             <span class="keyword">this</span>.clearSelectionButton.TabIndex = 7;
00482             <span class="keyword">this</span>.clearSelectionButton.Text = <span class="stringliteral">"Clear All Selections"</span>;
00483             <span class="keyword">this</span>.clearSelectionButton.Click += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.clearSelectionButton_Click);
00484             <span class="comment">// </span>
00485             <span class="comment">// Form1</span>
00486             <span class="comment">// </span>
00487             <span class="keyword">this</span>.AutoScaleBaseSize = <span class="keyword">new</span> System.Drawing.Size(5, 13);
00488             <span class="keyword">this</span>.ClientSize = <span class="keyword">new</span> System.Drawing.Size(500, 324);
00489             <span class="keyword">this</span>.Controls.AddRange(<span class="keyword">new</span> System.Windows.Forms.Control[] {
00490                                                                           <span class="keyword">this</span>.mapControl,
00491                                                                           <span class="keyword">this</span>.splitter1,
00492                                                                           <span class="keyword">this</span>.panel1,
00493                                                                           <span class="keyword">this</span>.statusBar1});
00494             <span class="keyword">this</span>.Icon = ((System.Drawing.Icon)(resources.GetObject(<span class="stringliteral">"$this.Icon"</span>)));
00495             <span class="keyword">this</span>.Menu = <span class="keyword">this</span>.mainMenu1;
00496             <span class="keyword">this</span>.Name = <span class="stringliteral">"Form1"</span>;
00497             <span class="keyword">this</span>.Text = <span class="stringliteral">"Shape.Net Viewer"</span>;
00498             <span class="keyword">this</span>.MouseMove += <span class="keyword">new</span> System.Windows.Forms.MouseEventHandler(<span class="keyword">this</span>.mapControl_MouseMove);
00499             ((System.ComponentModel.ISupportInitialize)(<span class="keyword">this</span>.statusBarPanel1)).EndInit();
00500             ((System.ComponentModel.ISupportInitialize)(<span class="keyword">this</span>.statusBarPanel2)).EndInit();
00501             ((System.ComponentModel.ISupportInitialize)(<span class="keyword">this</span>.statusBarPanel3)).EndInit();
00502             <span class="keyword">this</span>.panel1.ResumeLayout(<span class="keyword">false</span>);
00503             <span class="keyword">this</span>.groupBox2.ResumeLayout(<span class="keyword">false</span>);
00504             <span class="keyword">this</span>.groupBox1.ResumeLayout(<span class="keyword">false</span>);
00505             <span class="keyword">this</span>.ResumeLayout(<span class="keyword">false</span>);
00506 
00507         }
00508 <span class="preprocessor">        #endregion</span>
00509 <span class="preprocessor"></span>
00513         [STAThread]
00514         <span class="keyword">static</span> <span class="keywordtype">void</span> Main() 
00515         {
00516             Application.Run( <span class="keyword">new</span> Form1() );
00517         }
00518 
<a name="l00519"></a><a class="code" href="classExampleApplication_1_1Form1.html#ExampleApplication_1_1Form1a1">00519</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> Draw()
00520         {
00521             mapControl.Draw();
00522         }
00523 
00524         <span class="keyword">private</span> <span class="keywordtype">void</span> toolBar1_ButtonClick(object sender, System.Windows.Forms.ToolBarButtonClickEventArgs e)
00525         {
00526             <span class="keywordflow">switch</span>(mainToolBar.Buttons.IndexOf(e.Button))
00527             {
00528                 <span class="keywordflow">case</span> 0: <span class="comment">//Pointer - no action</span>
00529                     mainToolBar.Buttons[0].Pushed = <span class="keyword">true</span>;
00530                     mainToolBar.Buttons[1].Pushed = <span class="keyword">false</span>;
00531                     mainToolBar.Buttons[2].Pushed = <span class="keyword">false</span>;
00532                     mainToolBar.Buttons[3].Pushed = <span class="keyword">false</span>;
00533                     mainToolBar.Buttons[4].Pushed = <span class="keyword">false</span>;
00534                     mainToolBar.Buttons[5].Pushed = <span class="keyword">false</span>;
00535                     mapControl.PointerBehavior = ShapeDotNet.PointerMode.Select;
00536                     <span class="keywordflow">break</span>;
00537 
00538                 <span class="keywordflow">case</span> 1: <span class="comment">//Pointer - zoom</span>
00539                     mainToolBar.Buttons[0].Pushed = <span class="keyword">false</span>;
00540                     mainToolBar.Buttons[1].Pushed = <span class="keyword">true</span>;
00541                     mainToolBar.Buttons[2].Pushed = <span class="keyword">false</span>;
00542                     mainToolBar.Buttons[3].Pushed = <span class="keyword">false</span>;
00543                     mainToolBar.Buttons[4].Pushed = <span class="keyword">false</span>;
00544                     mainToolBar.Buttons[5].Pushed = <span class="keyword">false</span>;
00545                     mapControl.PointerBehavior = ShapeDotNet.PointerMode.Zoom;
00546                     <span class="keywordflow">break</span>;
00547 
00548                 <span class="keywordflow">case</span> 2: <span class="comment">//Pointer - zoom area</span>
00549                     mainToolBar.Buttons[0].Pushed = <span class="keyword">false</span>;
00550                     mainToolBar.Buttons[1].Pushed = <span class="keyword">false</span>;
00551                     mainToolBar.Buttons[2].Pushed = <span class="keyword">true</span>;
00552                     mainToolBar.Buttons[3].Pushed = <span class="keyword">false</span>;
00553                     mainToolBar.Buttons[4].Pushed = <span class="keyword">false</span>;
00554                     mainToolBar.Buttons[5].Pushed = <span class="keyword">false</span>;
00555                     mapControl.PointerBehavior = ShapeDotNet.PointerMode.ZoomArea;
00556                     <span class="keywordflow">break</span>;
00557 
00558                 <span class="keywordflow">case</span> 3: <span class="comment">//Pointer - drag</span>
00559                     mainToolBar.Buttons[0].Pushed = <span class="keyword">false</span>;
00560                     mainToolBar.Buttons[1].Pushed = <span class="keyword">false</span>;
00561                     mainToolBar.Buttons[2].Pushed = <span class="keyword">false</span>;
00562                     mainToolBar.Buttons[3].Pushed = <span class="keyword">true</span>;
00563                     mainToolBar.Buttons[4].Pushed = <span class="keyword">false</span>;
00564                     mainToolBar.Buttons[5].Pushed = <span class="keyword">false</span>;
00565                     mapControl.PointerBehavior = ShapeDotNet.PointerMode.Drag;
00566                     <span class="keywordflow">break</span>;
00567 
00568                 <span class="keywordflow">case</span> 4: <span class="comment">//Pointer - center</span>
00569                     mainToolBar.Buttons[0].Pushed = <span class="keyword">false</span>;
00570                     mainToolBar.Buttons[1].Pushed = <span class="keyword">false</span>;
00571                     mainToolBar.Buttons[2].Pushed = <span class="keyword">false</span>;
00572                     mainToolBar.Buttons[3].Pushed = <span class="keyword">false</span>;
00573                     mainToolBar.Buttons[4].Pushed = <span class="keyword">true</span>;
00574                     mainToolBar.Buttons[5].Pushed = <span class="keyword">false</span>;
00575                     mapControl.PointerBehavior = ShapeDotNet.PointerMode.Center;
00576                     <span class="keywordflow">break</span>;
00577 
00578                 <span class="keywordflow">case</span> 5: <span class="comment">//Pointer - query</span>
00579                     mainToolBar.Buttons[0].Pushed = <span class="keyword">false</span>;
00580                     mainToolBar.Buttons[1].Pushed = <span class="keyword">false</span>;
00581                     mainToolBar.Buttons[2].Pushed = <span class="keyword">false</span>;
00582                     mainToolBar.Buttons[3].Pushed = <span class="keyword">false</span>;
00583                     mainToolBar.Buttons[4].Pushed = <span class="keyword">false</span>;
00584                     mainToolBar.Buttons[5].Pushed = <span class="keyword">true</span>;
00585                     mapControl.PointerBehavior = ShapeDotNet.PointerMode.Query;
00586                     <span class="keywordflow">break</span>;
00587 
00588                 <span class="keywordflow">case</span> 6: <span class="comment">// Zoom to Extents</span>
00589                     mapControl.MapCollection.ZoomExtents();
00590                     mapControl.Draw();
00591                     <span class="keywordflow">break</span>;
00592 
00593             }
00594     
00595         }
00596 
00597         <span class="keyword">private</span> <span class="keywordtype">void</span> menuOpenFile_Click(object sender, System.EventArgs e)
00598         {           
00599             mapControl.AddLayer();
00600             UpdateLayerList();
00601         }
00602 
00603         <span class="keyword">private</span> <span class="keywordtype">void</span> menuHelpAbout_Click(object sender, System.EventArgs e)
00604         {
00605             string msg = <span class="stringliteral">"A small ESRI Shapefile Viewer built with\n"</span>;
00606             msg += mapControl.ProductName + <span class="stringliteral">" v"</span> + mapControl.ProductVersion + <span class="stringliteral">" (BETA 2)\n\n"</span>;
00607             msg += <span class="stringliteral">"(c)2002-2004 John Coleman &lt;k5jvc at netscape.net&gt;"</span>;
00608             
00609             MessageBox.Show(msg , <span class="stringliteral">"About Shape.Net..."</span>);
00610         }
00611 
00612         <span class="keyword">private</span> <span class="keywordtype">void</span> menuExit_Click(object sender, System.EventArgs e)
00613         {
00614             Application.Exit();
00615         }
00616 
00617         <span class="keyword">private</span> <span class="keywordtype">void</span> mapControl_MouseMove( object sender, System.Windows.Forms.MouseEventArgs e )
00618         {
00619             statusBar1.Panels[1].Text = mapControl.MouseGeoX.ToString(<span class="stringliteral">"F6"</span>) + <span class="stringliteral">" x "</span> + 
00620                                         mapControl.MouseGeoY.ToString(<span class="stringliteral">"F6"</span>);
00621         }
00622 
00623         <span class="keyword">private</span> <span class="keywordtype">void</span> mapControl_QueryResult( object sender, string[] result )
00624         {
00625             <span class="keywordflow">if</span> ( result != null &amp;&amp; queryField &lt; result.Length )
00626             {
00627                 statusBar1.Panels[0].Text = result[ queryField ].Trim();
00628             }
00629         }
00630 
00631         <span class="keyword">private</span> <span class="keywordtype">void</span> menuItemSaveToImage_Click(object sender, System.EventArgs e)
00632         {
00633             mapControl.SaveViewToImage();
00634         }
00635 
00636         <span class="keyword">private</span> <span class="keywordtype">void</span> layerToolBar_ButtonClick(object sender, System.Windows.Forms.ToolBarButtonClickEventArgs e)
00637         {
00638             <span class="keywordflow">switch</span>(layerToolBar.Buttons.IndexOf(e.Button))
00639             {
00640                 <span class="keywordflow">case</span> 0:
00641                     mapControl.AddLayer();
00642                     UpdateLayerList();
00643                     <span class="keywordflow">break</span>;
00644                 
00645                 <span class="keywordflow">case</span> 1:
00646                     <span class="keywordflow">if</span> ( layerListBox.SelectedIndex != -1 )
00647                     {
00648                         mapControl.RemoveLayer( layerListBox.SelectedIndex );
00649                         UpdateLayerList();
00650                     }
00651                     <span class="keywordflow">break</span>;
00652                 
00653                 <span class="keywordflow">case</span> 4:
00654                     <span class="keywordflow">if</span> ( layerListBox.SelectedIndex != -1 )
00655                     {
00656                         mapControl.MoveLayerUp( layerListBox.SelectedIndex );
00657                         UpdateLayerList();
00658                     }
00659                     <span class="keywordflow">break</span>;
00660                 
00661                 <span class="keywordflow">case</span> 5:
00662                     <span class="keywordflow">if</span> ( layerListBox.SelectedIndex != -1 )
00663                     {
00664                         mapControl.MoveLayerDown( layerListBox.SelectedIndex );
00665                         UpdateLayerList();
00666                     }
00667                     <span class="keywordflow">break</span>;
00668                 
00669                 <span class="keywordflow">case</span> 7:
00670                     <span class="keywordflow">if</span> ( layerListBox.SelectedIndex != -1 )
00671                     {
00672                         PropertiesForm pf = <span class="keyword">new</span> PropertiesForm( 
00673                             mapControl.MapCollection[ layerListBox.SelectedIndex ] );
00674                         
00675                         <span class="keywordflow">if</span> ( pf.ShowDialog()== DialogResult.OK )
00676                         {
00677                             Draw(); 
00678                         }
00679                     }
00680                     <span class="keywordflow">break</span>;
00681             }
00682 
00683         }
00684 
00685         <span class="keyword">private</span> <span class="keywordtype">void</span> UpdateLayerList()
00686         {
00687             queryComboBox.Items.Clear();
00688             
00689             string seperator = <span class="stringliteral">"\\"</span>;
00690             <span class="keywordtype">char</span>[] delimiter = seperator.ToCharArray() ;
00691             layerListBox.Items.Clear();
00692 
00693             foreach ( string s in mapControl.MapCollection.GetLayerNames() )
00694             {
00695                 string[] ss = s.Split( delimiter, 100 );
00696                 layerListBox.Items.Add( ss[ ss.Length - 1] );
00697             }
00698         }
00699 
00700         <span class="keyword">private</span> <span class="keywordtype">void</span> layerListBox_SelectedValueChanged(object sender, System.EventArgs e)
00701         {
00702             IMapLayer ml = mapControl.MapCollection[ layerListBox.SelectedIndex ];
00703             
00704             queryComboBox.Items.Clear();
00705             queryComboBox.Items.AddRange( ml.FieldNames );
00706             queryComboBox.SelectedIndex = 0;
00707             queryField = 0;
00708 
00709             mapControl.QueryLayer = layerListBox.SelectedIndex;
00710         }
00711 
00712         <span class="keyword">private</span> <span class="keywordtype">void</span> queryComboBox_SelectionChangeCommitted(object sender, System.EventArgs e)
00713         {
00714             queryField = queryComboBox.SelectedIndex;
00715         }
00716 
00717         <span class="keyword">private</span> <span class="keywordtype">void</span> clearSelectionButton_Click(object sender, System.EventArgs e)
00718         {
00719             <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> a=0; a&lt;layerListBox.Items.Count; ++a )
00720             {
00721                 mapControl.MapCollection[a].HighlightedFeature = -1;
00722             }
00723 
00724             mapControl.Draw();
00725         }
00726     }
00727 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Feb 10 17:52:39 2004 for MapControl by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
